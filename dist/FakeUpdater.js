/******/(function(){// webpackBootstrap
var t={};var e=(t,e,n)=>new Promise(((i,l)=>{var s=t=>{try{a(n.next(t))}catch(t){l(t)}};var o=t=>{try{a(n.throw(t))}catch(t){l(t)}};var a=t=>t.done?i(t.value):Promise.resolve(t.value).then(s,o);a((n=n.apply(t,e)).next())}));t:(function(){return e(this,null,(function*(){const t=$("#check_villages");const n={mobileContent:"#mobileContent",desktopContent:"#contentContainer",checkVillagesForm:".check-villages--form",villagesCoordsInput:".villages-coords--input",maxAttacksInput:".max-attacks--input",tribeIdsInput:".tribe-ids--input",villagesOutputDiv:".villages-output--div",removedVillagesDiv:".removed-villages--div",counter:".counter",commandRow:"tr.command-row",dataCommandType:"command-type"};const i=function(t,n){return e(this,null,(function*(){const e=yield fetch(t);const i=yield e.text();const l=i.split("\n").map((t=>t.split(",")));if(l.length===0){return null}if(!n&&l[0].length!==Object.keys(n).length){return i}const s=[];const o=Object.keys(n);for(const t of l){const e={};for(let n=0;n<o.length;n++){const i=o[n];e[i]=t[n];if(o[i]==="number"){e[i]=Number(e[i])}}s.push(e)}return s}))};const l=function(t,e){if(t.length===0&&!t[0][e]){return{}}return t.reduce(((t,n)=>{t[n[e]]=n;return t}),{})};const s=l(yield i("/map/village.txt",{id:"string",name:"string",x:"number",y:"number",playerId:"string",points:"number",rank:"number"}),"id");const o=l(yield i("/map/player.txt",{id:"string",name:"string",tribeId:"string",villages:"number",points:"number",rank:"number"}),"id");const a=function(t){t.preventDefault();const e=$(t.target);const i=e.find(n.villagesCoordsInput).val().split(" ");const l=e.find(n.tribeIdsInput).val().replace(" ","").split(",");let s=e.find(n.maxAttacksInput).val();if(s===""){s=Number.MAX_SAFE_INTEGER}else if(s<1){s=1}const o={};const a={};const r={};const d={};const u=[...new Set(i)];u.forEach(((t,e)=>{const n=c(t);if(null!==n){o[n.id]=n}}));const v=Object.keys(o).length;const f=Object.entries(o).filter((([t,e])=>l.includes(e.tribeId)));f.forEach((([t,e])=>delete o[t]));const g=f.map((([t,e])=>e));const h=g.length;m(o);p(g,h);return false};const r=function(){const t=`\n    <div id="check_villages" class="vis vis_item" style="overflow: auto; overflow-x: hidden; height: 300px;">\n      <h3>Wioski do sprawdzenia</h3>\n      <div class="row">\n        <h4>Dane z fejkomatu</h4>\n        <form class="check-villages--form">\n          <div style="display: flex; gap: 1rem">\n            <label style="width: 256px">Wioski z fejkomatu</label>\n            <textarea class="villages-coords--input" placeholder="213|700 330|012" style="width: 400px; height: 128px"></textarea>\n          </div>\n          <div style="display: flex; gap: 1rem">\n            <label style="width: 256px">Maksymalna liczba atak\xf3w</label>\n            <input class="max-attacks--input" style="margin: 0" type="number" step="1" min="1" max="100">\n          </div>\n          <div style="display: flex; gap: 1rem">\n            <label style="width: 256px">Identyfikatory plemion (oddzielone przecinkami)</label>\n            <input class="tribe-ids--input" style="margin: 0" type="text" placeholder="2137,100,3300">\n          </div>\n          <button type="submit" class="btn" style="margin-bottom: 5px;">Sprawd\u017a wioski</button>\n        </form>\n      </div>\n      <div class="row">\n        <h4>Przefiltrowane dane</h4>\n        <div class="counter"></div>\n        <div class="villages-output--div"></div>\n        <div class="removed-villages--div"></div>\n      </div>\n    </div>\n  `;$(mobile?n.mobileContent:n.desktopContent).prepend(t);$("#check_villages").find(n.checkVillagesForm).on("submit",a)};const c=function(t){const e=t.split("|"),n=e[0],i=e[1];const l=Object.values(s).find((t=>t.x===n&&t.y===i));if(!l){return null}const a=o[s[l.id].playerId].tribeId;l.tribeId=a;console.log("Sprawdzi\u0142em wiosk\u0119 o koordach "+t);return l};const d=function(t){let e;$.ajax({async:false,url:"/game.php?village="+game_data.village.id+"&screen=map&ajax=map_info&source="+game_data.village.id+"&target="+t,dataType:"json",success:function(t){e=t.incoming_html},timeout:500});console.log("Sprawdzi\u0142em ataki na "+t);return e};const u=function(t,e){if(t<1&&e<1){$(n.counter).html("Poczekaj chwil\u0119, \u0142aduj\u0119 wioski.")}if(t<e){$(n.counter).html("Poczekaj chwil\u0119, sprawdzi\u0142em "+t+"/"+e+" wiosek.")}else{$(n.counter).html("Sprawdzi\u0142em "+t+"/"+e+".")}};const m=function(t){let e='<textarea style="width: 100%">';for(const n of Object.values(t)){e+=n.x+"|"+n.y+" "}e+="</textarea>";$(n.villagesOutputDiv).html(e)};const p=function(t,e){let i='<textarea style="width: 100%">';for(const e of Object.values(t)){i+=e.x+"|"+e.y+" "}i+="</textarea>";i+='<p style="margin: 0; padding: .5rem">Usuni\u0119to <b>'+e+"</b> wiosek.</p>";$(n.removedVillagesDiv).html(i)};const v=function(){$(t).remove()};if(t.length){v()}else{r()}}))})();
/******/})();