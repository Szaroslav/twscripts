!function(){"use strict";var e={MAX_MEMO_SIZE:"number"==typeof char_limit?char_limit:6e4,MSG_DURATION:1400,createdMemoIds:[],create:function(e){var t=this,o=this.splitSchedule(e);if(null!==o){UI.SuccessMessage("Tworz\u0119 rozpisk\u0119, mo\u017ce to zaj\u0105\u0107 kilka sekund.",this.MSG_DURATION);for(var n=$.Deferred().resolve(),a=function(e){n=n.then((function(){return t.addTab()})).then((function(){return t.renameTab("Rozpiska [".concat(e+1,"]"))})).then((function(){return t.setContent(o[e])}))},r=0;r<o.length;r++)a(r);n.then((function(){Memo.selectTab(t.createdMemoIds[0]),UI.SuccessMessage("Rozpiska zosta\u0142a utworzona. Od\u015bwie\u017cam stron\u0119.",t.MSG_DURATION),setTimeout((function(){return location.reload()}),t.MSG_DURATION+600)}))}else UI.ErrorMessage("Nie uda\u0142o si\u0119 utworzy\u0107 rozpiski.",this.MSG_DURATION)},addTab:function(){var e=this;if(!(Memo.tabs.length>=10))return Memo.mobile&&Memo.checkArrow(Memo.tabs.length),$.ajax({url:$("#add_tab_url").val(),type:"POST",dataType:"json",data:{},success:function(e){if(e&&e.id){if(Memo.tabs.push(e)>=Memo.max_tabs&&$("#memo-add-tab-button").hide(),$("div.memo-tab").length>=1)var t=$("div.memo-tab").first().clone();else location.reload();Memo.editTabElement(t,e.id,e.title,!0),t.appendTo($("#tab-bar")),$(".memo-tab-button-close").show();var o=$("div.memo_container").first().clone(),n=o.attr("id").substr(5);o.attr("id","memo_"+e.id),$("input[name='tab_id']",o).val(e.id),$("tr.show_row > td",o).empty(),$("textarea",o).val("").last().attr("id","message_"+e.id),$("tr.bbcodes > td",o).empty(),o.insertAfter($("div.memo_container").last()),Memo.Memory.toggle[n]&&$(".show_row, .edit_link, .edit_row, .submit_row, .bbcodes",$("#memo_"+e.id)).toggle(),Memo.selectTab(e.id)}}}).then((function(t){return e.createdMemoIds.push(t.id)}));UI.ErrorMessage(s(_("3531dec6f954a7d15f46b4cf644c5bfe"),Memo.tabs.length),this.MSG_DURATION)},renameTab:function(e){var t=Memo.tabs[Memo.findTab(Memo.selectedTab)];if(t.title=e,t.title&&t.length>16)UI.ErrorMessage(Memo.messages.tabNameLength,this.MSG_DURATION);else{if(0!=e.length)return $.ajax({url:$("#rename_tab_url").val(),type:"POST",dataType:"json",data:{id:t.id,newTitle:t.title},success:function(e){e.title&&(Memo.tabs[Memo.findTab(Memo.selectedTab)].title=e.title,Memo.selectTab()),Dialog.close()}});UI.ErrorMessage(Memo.messages.tabNameEmpty,this.MSG_DURATION)}},setContent:function(e){var t=this;document.querySelector("#message_".concat(Memo.selectedTab)).value=e;var o=document.querySelector("#memo_".concat(Memo.selectedTab," form")),n={memo:o.elements.memo.value,tab_id:o.elements.tab_id.value,h:o.elements.h.value};return $.ajax(o.action,{method:"POST",data:n}).then((function(e,o){"success"!==o&&UI.ErrorMessage("Nie uda\u0142o si\u0119 utworzy\u0107 rozpiski.",t.MSG_DURATION)}))},splitSchedule:function(e){var t=this;if(e instanceof Array==!1)return null;var o=[],n="";return e.forEach((function(e){var a=e.join("");n.length+a.length+"\r\n".length>t.MAX_MEMO_SIZE&&(o.push(n),n=""),""!==n&&(n+="\r\n"),n+=a})),""!==n&&o.push(n),o}};({MSG_DURATION:1400,init:function(){if(console.log("%cScheduleMerger.js %cv0.9","display: inline-block; padding: 4px 0","display: inline-block; padding: 4px; background-color: #2151ae; color: white"),console.log("Skrypt stworzony przez %cSzary %c(Plemiona: %cAGH Szary%c)","font-weight: bold","font-weight: normal","font-weight: bold","font-weight: normal"),"undefined"!=typeof Memo){this.MSG_DURATION=e.MSG_DURATION;var t=this.getSchedule();e.create(t)}else UI.ErrorMessage("Nie jeste\u015b w notatkach. Przenosz\u0119."),setTimeout((function(){return location.href="".concat(location.origin,"/game.php?screen=memo")}),this.MSG_DURATION+600)},getSchedule:function(){var e=[];return document.querySelectorAll(".memo_container").forEach((function(t){for(var o=t.querySelector('textarea[name="memo"]').value.split("\n").filter((function(e){return""!==e})).filter((function(e){return/^[0-9]{1,}./.test(e)||/^\[b\][0-9]{4}-[0-9]{2}-[0-9]{2}/.test(e)||/Wy\u015blij \w+\[\/url]$/.test(e)})).map((function(e){return e+"\r\n"})),n=0;n<o.length;n+=3){if(n+2>=o.length)return;e.push([o[n],o[n+1],o[n+2]])}})),e.sort((function(e,t){return new Date("".concat(e[1].match(/[0-9]{4}-[0-9]{2}-[0-9]{2}/),"T").concat(e[1].match(/[0-9]{2}:[0-9]{2}:[0-9]{2}/)))-new Date("".concat(t[1].match(/[0-9]{4}-[0-9]{2}-[0-9]{2}/),"T").concat(t[1].match(/[0-9]{2}:[0-9]{2}:[0-9]{2}/)))})),e.forEach((function(e,t){return e[0]=e[0].replace(/^[0-9]{1,}./,"".concat(t+1,"."))})),e}}).init()}();